<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Gyro Typo Playground</title>
  <style>
    body, html { margin:0; padding:0; overflow:hidden; }
    canvas { display:block; }
    #input { position: absolute; top: 10px; left: 10px; }
  </style>
</head>
<body>
  <input id="input" type="text" placeholder="Tippe hier..." />

  <canvas id="world"></canvas>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
  <script>
    const { Engine, Render, Runner, World, Bodies, Body, Composite } = Matter;

    const engine = Engine.create();
    const world = engine.world;

    const canvas = document.getElementById('world');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const render = Render.create({
      canvas: canvas,
      engine: engine,
      options: { width: canvas.width, height: canvas.height, wireframes: false, background: '#fafafa' }
    });

    Render.run(render);
    Runner.run(Runner.create(), engine);

    // Wände
    const thickness = 50;
    const walls = [
      Bodies.rectangle(canvas.width/2, canvas.height+thickness/2, canvas.width, thickness, { isStatic: true }), // Boden
      Bodies.rectangle(canvas.width/2, -thickness/2, canvas.width, thickness, { isStatic: true }), // Decke
      Bodies.rectangle(-thickness/2, canvas.height/2, thickness, canvas.height, { isStatic: true }), // links
      Bodies.rectangle(canvas.width+thickness/2, canvas.height/2, thickness, canvas.height, { isStatic: true }) // rechts
    ];
    World.add(world, walls);

    // Buchstaben hinzufügen
    const input = document.getElementById('input');
    input.addEventListener('input', e => {
      const char = e.data;
      if (!char) return;

      const size = 50;

      // Einfacher: Rechteckkörper + Text im Renderer sichtbar machen
      const body = Bodies.rectangle(canvas.width/2, 100, size, size, {
        friction: 0.8,
        frictionStatic: 1,
        restitution: 0.2,
        render: {
          fillStyle: '#222',
          text: { content: char, size: size, color: "white" }
        }
      });

      // Zeichne Text auf Body (HACK via plugin-like override)
      const oldDraw = render.context.drawImage;
      render.context.drawImage = function() {
        oldDraw.apply(this, arguments);
        render.context.font = size + "px Arial";
        render.context.fillStyle = "#222";
        render.context.textAlign = "center";
        render.context.textBaseline = "middle";
        render.context.fillText(char, body.position.x, body.position.y);
      };

      Body.setMass(body, size * 0.5);
      World.add(world, body);

      // Entferne nach 30s
      setTimeout(() => {
        World.remove(world, body);
      }, 30000);
    });

    // Gyroskop → Gravitation
    if (window.DeviceOrientationEvent) {
      window.addEventListener("deviceorientation", (event) => {
        const tiltX = event.gamma;  // links-rechts
        const tiltY = event.beta;   // vor/zurück
        engine.world.gravity.x = tiltX / 20;
        engine.world.gravity.y = tiltY / 20;
      });
    }
  </script>
</body>
</html>
